<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Crear Usuario — PadelFlow</title>
    <link rel="stylesheet" href="/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <link rel="stylesheet" href="/assets/css/styles.css" />
    <link rel="stylesheet" href="/assets/css/dashboard.css" />
</head>

<body>
    <%- include('partials/admin_header') %>
        <div class="admin-shell">
            <%- include('partials/admin_sidebar') %>
                <div class="main flex-grow-1">
                    <main class="container-fluid p-4">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h1 class="h3 mb-0">Crear Nuevo Usuario</h1>
                        </div>

                        <div class="card shadow-sm mb-4">
                            <div class="card-body">
                                <form action="/admin/users/create" method="POST">
                                    <div class="mb-3">
                                        <label for="name" class="form-label">Nombre</label>
                                        <input type="text" class="form-control" id="name" name="name" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="email" class="form-label">Email</label>
                                        <input type="email" class="form-control" id="email" name="email" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="password" class="form-label">Contraseña</label>
                                        <input type="password" class="form-control" id="password" name="password" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="role" class="form-label">Rol</label>
                                        <select class="form-select" id="role" name="role" required>
                                            <option value="">Selecciona un rol</option>
                                            <option value="player">Jugador</option>
                                            <option value="club_admin">Administrador de Club</option>
                                            <option value="platform_admin">Administrador de Plataforma</option>
                                        </select>
                                    </div>
                                    <div class="mb-3" id="clubSelectGroup" style="display: none;">
                                        <label for="club_id" class="form-label">Club (solo para Admin de Club)</label>
                                        <select class="form-select" id="club_id" name="club_id">
                                            <option value="">Ninguno</option>
                                            <% clubs.forEach(club => { %>
                                                <option value="<%= club.id %>"><%= club.name %></option>
                                            <% }); %>
                                        </select>
                                    </div>
                                    <button type="submit" class="btn btn-primary">Crear Usuario</button>
                                    <a href="/admin/dashboard" class="btn btn-secondary">Cancelar</a>
                                </form>
                            </div>
                        </div>
                    </main>
                </div>
        </div>

        <script src="/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
        <script src="/assets/js/main.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                const roleSelect = document.getElementById('role');
                const clubSelectGroup = document.getElementById('clubSelectGroup');

                function toggleClubSelect() {
                    if (roleSelect.value === 'club_admin') {
                        clubSelectGroup.style.display = 'block';
                    } else {
                        clubSelectGroup.style.display = 'none';
                    }
                }

                roleSelect.addEventListener('change', toggleClubSelect);
                toggleClubSelect(); // Call on load to set initial state
            });
        </script>
</body>

</html>